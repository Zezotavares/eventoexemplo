<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Eventos Fortral</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        /* Ajuste para tabela com scroll no celular */
        .table-container { overflow-x: auto; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen font-sans">

    <div class="bg-slate-900 p-4 text-center shadow-md relative z-10">
        <img src="https://www.fortral.com.br/wp-content/uploads/2025/06/logo.png" 
             alt="Logo Fortral" class="h-10 mx-auto object-contain mb-2">
        <h1 class="text-white font-bold text-lg" id="headerTitulo">Portal de Eventos</h1>
    </div>

    <div class="max-w-4xl mx-auto mt-6 px-4 pb-10">

        <div id="areaLogin" class="hidden max-w-sm mx-auto bg-white p-6 rounded-lg shadow-lg text-center mt-10">
            <div class="bg-blue-50 p-3 rounded text-blue-900 text-sm mb-4 flex items-center justify-center gap-2">
                <i class="ph ph-lock-key text-xl"></i> <span>Acesso Administrativo</span>
            </div>
            <div class="relative w-full mb-4">
                <input type="password" id="senhaAdmin" placeholder="Senha de acesso" 
                       class="w-full p-2 pr-10 border rounded text-center focus:border-blue-900 outline-none">
                <button type="button" onclick="toggleSenha()" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-blue-900">
                    <i class="ph ph-eye text-xl" id="iconeOlho"></i>
                </button>
            </div>
            <button onclick="verificarSenha()" class="w-full bg-slate-900 text-white p-2 rounded hover:bg-slate-800 font-bold">Entrar no Painel</button>
        </div>

        <div id="areaCliente" class="hidden max-w-md mx-auto bg-white p-6 rounded-lg shadow-lg">
            
            <div class="text-center mb-6 border-b pb-4">
                <h2 class="text-2xl font-bold text-slate-900" id="eventoNomeDisplay">Evento</h2>
                <div id="eventoDataDisplay" class="inline-flex items-center gap-1 bg-blue-50 text-blue-800 px-3 py-1 rounded-full text-xs font-bold mt-2">
                    <i class="ph ph-calendar"></i> <span id="textoDataEvento"></span>
                </div>
            </div>

            <form id="formCadastro" class="space-y-4">
                <input type="hidden" id="eventoIdInput">
                <div>
                    <label class="block text-xs font-bold text-gray-600 uppercase">Nome Completo</label>
                    <input type="text" id="clienteNome" required class="w-full p-2 border rounded mt-1 focus:border-blue-900 outline-none">
                </div>
                <div class="flex gap-2">
                    <div class="w-1/2">
                        <label class="block text-xs font-bold text-gray-600 uppercase">CPF</label>
                        <input type="text" id="clienteCPF" maxlength="14" onkeyup="mascaraCPF(this)" required 
                               placeholder="000.000.000-00" class="w-full p-2 border rounded mt-1 outline-none">
                    </div>
                    <div class="w-1/2">
                        <label class="block text-xs font-bold text-gray-600 uppercase">WhatsApp</label>
                        <input type="tel" id="clienteTelefone" maxlength="15" onkeyup="mascaraTelefone(this)" required 
                               placeholder="(00) 00000-0000" class="w-full p-2 border rounded mt-1 outline-none">
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-600 uppercase">E-mail</label>
                    <input type="email" id="clienteEmail" class="w-full p-2 border rounded mt-1 outline-none">
                </div>
                
                <div class="bg-gray-50 p-3 rounded border">
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-sm font-bold text-gray-700">Vai levar acompanhantes?</label>
                        <input type="number" id="clienteQtdAcomp" min="0" value="0" class="w-16 p-1 border rounded text-center" onchange="toggleAreaAcompanhantes()">
                    </div>
                    <div id="areaDadosAcompanhantes" class="hidden animate-fade-in">
                        <textarea id="clienteDadosAcomp" rows="2" class="w-full p-2 border rounded text-sm" placeholder="Nome dos acompanhantes..."></textarea>
                    </div>
                </div>

                <button type="submit" id="btnSalvar" class="w-full bg-blue-900 text-white p-3 rounded hover:bg-blue-800 font-bold text-lg transition shadow-lg">
                    Confirmar Presença
                </button>
            </form>

            <div id="msgSucesso" class="hidden text-center py-6">
                <div class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph ph-check text-4xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-900">Tudo Certo!</h2>
                <p class="text-gray-600 mb-6">Sua inscrição foi realizada.</p>
                <div class="bg-slate-50 p-4 rounded border border-slate-200 inline-block text-left w-full">
                    <p class="text-xs text-gray-500 uppercase font-bold">Lembre-se:</p>
                    <p class="text-slate-900 font-medium" id="sucessoDataMsg"></p>
                </div>
            </div>
        </div>

        <div id="areaAdmin" class="hidden bg-white rounded-lg shadow-xl overflow-hidden min-h-[500px]">
            
            <div class="bg-slate-800 text-white p-4 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <div class="bg-blue-600 p-1.5 rounded-full"><i class="ph ph-user-gear text-lg"></i></div>
                    <span class="font-bold">Painel Gerencial</span>
                </div>
                <button onclick="logout()" class="text-xs text-red-300 hover:text-white border border-red-900 hover:bg-red-900 px-3 py-1 rounded transition">Sair</button>
            </div>

            <div class="flex border-b">
                <button onclick="mudarAba('eventos')" id="tabEventos" class="flex-1 py-3 font-bold text-slate-600 border-b-2 border-transparent hover:bg-gray-50 bg-gray-100">
                    <i class="ph ph-calendar-plus"></i> Meus Eventos
                </button>
                <button onclick="mudarAba('participantes')" id="tabParticipantes" class="flex-1 py-3 font-bold text-blue-900 border-b-2 border-blue-900 bg-white">
                    <i class="ph ph-users-three"></i> Gerenciar Inscritos
                </button>
            </div>

            <div id="viewEventos" class="hidden p-6">
                <h3 class="font-bold text-lg text-slate-700 mb-4">Criar Novo Evento</h3>
                <div class="bg-gray-50 p-4 rounded border mb-6">
                    <div class="grid gap-3 md:grid-cols-3">
                        <input type="text" id="novoEventoNome" placeholder="Nome do Evento" class="md:col-span-2 w-full p-2 border rounded">
                        <input type="datetime-local" id="novoEventoData" class="w-full p-2 border rounded text-gray-600">
                    </div>
                    <button onclick="criarEvento()" class="mt-3 w-full bg-slate-900 text-white py-2 rounded font-bold hover:bg-slate-800">
                        + Criar Evento
                    </button>
                </div>

                <h3 class="font-bold text-lg text-slate-700 mb-2">Links Ativos</h3>
                <ul id="listaEventosLinks" class="space-y-2 text-sm max-h-60 overflow-y-auto">
                    </ul>
            </div>

            <div id="viewParticipantes" class="p-4 md:p-6">
                
                <div class="flex flex-col md:flex-row gap-3 mb-4 items-end">
                    <div class="w-full md:w-1/3">
                        <label class="text-xs font-bold text-gray-500 uppercase">Filtrar por Evento:</label>
                        <select id="filtroEvento" onchange="carregarParticipantesPainel()" class="w-full p-2 border border-blue-200 rounded bg-blue-50 font-medium text-blue-900">
                            <option value="">Todos os Eventos</option>
                        </select>
                    </div>
                    <div class="w-full md:w-1/3">
                        <label class="text-xs font-bold text-gray-500 uppercase">Buscar (Nome/CPF):</label>
                        <input type="text" id="buscaInput" onkeyup="filtrarTabela()" placeholder="Digite para buscar..." class="w-full p-2 border rounded">
                    </div>
                    <div class="w-full md:w-1/3 flex gap-2">
                        <button onclick="exportarExcel()" class="flex-1 bg-green-600 text-white p-2 rounded hover:bg-green-700 font-bold text-sm flex items-center justify-center gap-1">
                            <i class="ph ph-microsoft-excel-logo text-lg"></i> Excel
                        </button>
                        <button onclick="carregarParticipantesPainel()" class="w-10 bg-gray-200 rounded flex items-center justify-center hover:bg-gray-300">
                            <i class="ph ph-arrow-clockwise text-lg"></i>
                        </button>
                    </div>
                </div>

                <div class="flex gap-4 mb-4 text-sm">
                    <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded font-bold">
                        Titulares: <span id="countTitulares">0</span>
                    </div>
                    <div class="bg-purple-100 text-purple-800 px-3 py-1 rounded font-bold">
                        Acompanhantes: <span id="countAcomp">0</span>
                    </div>
                    <div class="bg-gray-100 text-gray-800 px-3 py-1 rounded font-bold">
                        Total Geral: <span id="countTotal">0</span>
                    </div>
                </div>

                <div class="table-container border rounded-lg overflow-hidden">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-slate-100 text-slate-700 font-bold uppercase text-xs">
                            <tr>
                                <th class="p-3">Nome / CPF</th>
                                <th class="p-3">Contato</th>
                                <th class="p-3">Evento</th>
                                <th class="p-3 text-center">Acomp.</th>
                                <th class="p-3 text-center">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaParticipantes" class="divide-y divide-gray-100">
                            <tr><td colspan="5" class="p-4 text-center text-gray-500">Carregando dados...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>

    <script>
        // --- 1. CONFIGURAÇÃO ---
        const supabaseUrl = 'https://kixlaiwclsgbabtdfmtn.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtpeGxhaXdjbHNnYmFidGRmbXRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1NjA4MzgsImV4cCI6MjA4MzEzNjgzOH0.r9OF9C88prJs4tuBkz6xu_lKjjzixz5UHnVKDbLtx2E';
        const SENHA_ADMIN = 'Fortral@1993';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        // --- 2. CONTROLE DE TELA ---
        const areaLogin = document.getElementById('areaLogin');
        const areaCliente = document.getElementById('areaCliente');
        const areaAdmin = document.getElementById('areaAdmin');
        const urlParams = new URLSearchParams(window.location.search);
        const eventoIdParam = urlParams.get('evento_id');

        if (eventoIdParam) {
            iniciarModoCliente(eventoIdParam);
        } else {
            mostrarLogin();
        }

        // --- 3. FUNÇÕES GERAIS ---
        function mostrarLogin() { areaLogin.classList.remove('hidden'); }
        
        function verificarSenha() {
            if (document.getElementById('senhaAdmin').value === SENHA_ADMIN) {
                areaLogin.classList.add('hidden');
                iniciarModoAdmin();
            } else alert("Senha incorreta!");
        }

        function toggleSenha() {
            const input = document.getElementById('senhaAdmin');
            const icon = document.getElementById('iconeOlho');
            input.type = input.type === "password" ? "text" : "password";
            icon.classList.toggle('ph-eye');
            icon.classList.toggle('ph-eye-slash');
        }

        function logout() { location.reload(); }

        function formatarZap(telefone) {
            // Remove tudo que não é número para criar link
            return telefone.replace(/\D/g, "");
        }

        function mudarAba(aba) {
            const viewEventos = document.getElementById('viewEventos');
            const viewParticipantes = document.getElementById('viewParticipantes');
            const tabEventos = document.getElementById('tabEventos');
            const tabParticipantes = document.getElementById('tabParticipantes');

            if (aba === 'eventos') {
                viewEventos.classList.remove('hidden');
                viewParticipantes.classList.add('hidden');
                
                tabEventos.classList.add('border-blue-900', 'bg-white', 'text-blue-900');
                tabEventos.classList.remove('border-transparent', 'bg-gray-100', 'text-slate-600');
                
                tabParticipantes.classList.remove('border-blue-900', 'bg-white', 'text-blue-900');
                tabParticipantes.classList.add('border-transparent', 'bg-gray-100', 'text-slate-600');
            } else {
                viewEventos.classList.add('hidden');
                viewParticipantes.classList.remove('hidden');

                tabParticipantes.classList.add('border-blue-900', 'bg-white', 'text-blue-900');
                tabParticipantes.classList.remove('border-transparent', 'bg-gray-100', 'text-slate-600');

                tabEventos.classList.remove('border-blue-900', 'bg-white', 'text-blue-900');
                tabEventos.classList.add('border-transparent', 'bg-gray-100', 'text-slate-600');
            }
        }

        // --- 4. MÓDULO CLIENTE ---
        function mascaraTelefone(i) {
            let v = i.value.replace(/\D/g, "");
            v = v.replace(/^(\d\d)(\d)/g, "($1) $2");
            v = v.replace(/(\d{5})(\d)/, "$1-$2");
            i.value = v;
        }
        function mascaraCPF(i) {
            let v = i.value.replace(/\D/g, "");
            i.value = v.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
        }
        function toggleAreaAcompanhantes() {
            const qtd = document.getElementById('clienteQtdAcomp').value;
            const area = document.getElementById('areaDadosAcompanhantes');
            if(qtd > 0) area.classList.remove('hidden');
            else area.classList.add('hidden');
        }

        async function iniciarModoCliente(id) {
            const { data, error } = await supabaseClient
                .from('eventos')
                .select('*')
                .eq('id', id)
                .single();

            if (error || !data) {
                document.body.innerHTML = "<div class='text-center mt-10 p-4'><h1>Evento não encontrado ou link inválido.</h1></div>";
                return;
            }

            areaCliente.classList.remove('hidden');
            document.getElementById('headerTitulo').innerText = "Inscrição Online";
            document.getElementById('eventoNomeDisplay').innerText = data.nome;
            document.getElementById('eventoIdInput').value = id;

            if (data.data_evento) {
                const dataObj = new Date(data.data_evento);
                const strData = dataObj.toLocaleDateString('pt-BR') + ' às ' + dataObj.toLocaleTimeString('pt-BR', {hour:'2-digit', minute:'2-digit'});
                document.getElementById('textoDataEvento').innerText = strData;
                document.getElementById('sucessoDataMsg').innerText = "Evento: " + data.nome + " - " + strData;
            }
        }

        document.getElementById('formCadastro').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('btnSalvar');
            const originalText = btn.innerHTML;
            btn.innerHTML = "Enviando..."; btn.disabled = true;

            const dados = {
                evento_id: document.getElementById('eventoIdInput').value,
                nome: document.getElementById('clienteNome').value,
                cpf: document.getElementById('clienteCPF').value,
                telefone: document.getElementById('clienteTelefone').value,
                email: document.getElementById('clienteEmail').value,
                acompanhantes_qtd: document.getElementById('clienteQtdAcomp').value || 0,
                acompanhantes_info: document.getElementById('clienteDadosAcomp').value
            };

            const { data: existe } = await supabaseClient
                .from('participantes')
                .select('id')
                .eq('evento_id', dados.evento_id)
                .eq('cpf', dados.cpf)
                .maybeSingle();

            if (existe) {
                alert("Este CPF já está inscrito neste evento.");
                btn.innerHTML = originalText; btn.disabled = false;
                return;
            }

            const { error } = await supabaseClient.from('participantes').insert([dados]);
            if (error) {
                alert("Erro: " + error.message);
                btn.innerHTML = originalText; btn.disabled = false;
            } else {
                document.getElementById('formCadastro').classList.add('hidden');
                document.getElementById('msgSucesso').classList.remove('hidden');
                document.getElementById('eventoNomeDisplay').classList.add('hidden');
                document.getElementById('eventoDataDisplay').classList.add('hidden');
            }
        });

        // --- 5. MÓDULO ADMIN (NOVO) ---
        function iniciarModoAdmin() {
            areaAdmin.classList.remove('hidden');
            mudarAba('participantes'); // Inicia na aba mais importante
            carregarEventosParaSelect();
            carregarEventosLinks();
            carregarParticipantesPainel();
        }

        // ADMIN: Eventos
        async function criarEvento() {
            const nome = document.getElementById('novoEventoNome').value;
            const dataEv = document.getElementById('novoEventoData').value;
            if(!nome || !dataEv) return alert("Preencha todos os campos.");

            const { error } = await supabaseClient.from('eventos').insert([{ nome, data_evento: dataEv }]);
            if(error) alert("Erro: " + error.message);
            else {
                document.getElementById('novoEventoNome').value = "";
                alert("Evento criado!");
                carregarEventosLinks();
                carregarEventosParaSelect();
            }
        }

        async function carregarEventosLinks() {
            const { data } = await supabaseClient.from('eventos').select('*').order('data_criacao', {ascending: false});
            const ul = document.getElementById('listaEventosLinks');
            ul.innerHTML = "";
            if(data) {
                data.forEach(ev => {
                    const link = window.location.origin + window.location.pathname + "?evento_id=" + ev.id;
                    const dataFormatada = new Date(ev.data_evento).toLocaleDateString('pt-BR');
                    ul.innerHTML += `
                        <li class="bg-white border rounded p-3 flex justify-between items-center">
                            <div>
                                <strong class="text-slate-800">${ev.nome}</strong>
                                <div class="text-xs text-gray-500">${dataFormatada}</div>
                            </div>
                            <button onclick="navigator.clipboard.writeText('${link}').then(()=>alert('Copiado!'))" 
                                    class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded font-bold hover:bg-blue-200">
                                Copiar Link
                            </button>
                        </li>
                    `;
                });
            }
        }

        // ADMIN: Participantes e Gestão
        async function carregarEventosParaSelect() {
            const { data } = await supabaseClient.from('eventos').select('id, nome').order('data_criacao', {ascending: false});
            const select = document.getElementById('filtroEvento');
            select.innerHTML = '<option value="">Todos os Eventos</option>';
            if(data) {
                data.forEach(ev => {
                    select.innerHTML += `<option value="${ev.id}">${ev.nome}</option>`;
                });
            }
        }

        async function carregarParticipantesPainel() {
            const tbody = document.getElementById('tabelaParticipantes');
            tbody.innerHTML = '<tr><td colspan="5" class="p-4 text-center"><i class="ph ph-spinner animate-spin text-2xl"></i></td></tr>';

            let query = supabaseClient
                .from('participantes')
                .select('id, nome, cpf, telefone, email, acompanhantes_qtd, acompanhantes_info, eventos(nome)')
                .order('data_cadastro', { ascending: false });

            const eventoFiltro = document.getElementById('filtroEvento').value;
            if (eventoFiltro) {
                query = query.eq('evento_id', eventoFiltro);
            }

            const { data, error } = await query;

            if (error) {
                tbody.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-red-500">Erro ao carregar.</td></tr>';
                return;
            }

            if (!data || data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">Nenhum registro encontrado.</td></tr>';
                atualizarContadores([]);
                return;
            }

            atualizarContadores(data);
            renderizarTabela(data);
        }

        function renderizarTabela(lista) {
            const tbody = document.getElementById('tabelaParticipantes');
            tbody.innerHTML = "";
            
            lista.forEach(p => {
                const zapLink = `https://wa.me/55${formatarZap(p.telefone)}`;
                const temAcomp = p.acompanhantes_qtd > 0;
                
                tbody.innerHTML += `
                    <tr class="bg-white hover:bg-blue-50 transition border-b group">
                        <td class="p-3">
                            <div class="font-bold text-slate-800">${p.nome}</div>
                            <div class="text-xs text-gray-500 font-mono">${p.cpf || 'Sem CPF'}</div>
                        </td>
                        <td class="p-3">
                            <a href="${zapLink}" target="_blank" class="flex items-center gap-1 text-green-600 font-bold hover:underline">
                                <i class="ph ph-whatsapp-logo text-lg"></i> ${p.telefone}
                            </a>
                            <div class="text-xs text-gray-400 mt-1">${p.email || ''}</div>
                        </td>
                        <td class="p-3">
                            <span class="bg-gray-100 px-2 py-1 rounded text-xs border border-gray-200">
                                ${p.eventos?.nome}
                            </span>
                        </td>
                        <td class="p-3 text-center">
                            ${temAcomp 
                                ? `<div class="tooltip-container relative group cursor-help">
                                     <span class="bg-purple-100 text-purple-800 font-bold px-2 py-1 rounded-full text-xs">+${p.acompanhantes_qtd}</span>
                                     <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block w-48 bg-slate-800 text-white text-xs p-2 rounded z-20 shadow-lg">
                                        ${p.acompanhantes_info || 'Sem nomes'}
                                     </div>
                                   </div>` 
                                : '<span class="text-gray-300">-</span>'}
                        </td>
                        <td class="p-3 text-center">
                            <button onclick="deletarParticipante(${p.id})" class="text-red-400 hover:text-red-600 p-2 rounded hover:bg-red-50" title="Excluir">
                                <i class="ph ph-trash text-xl"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
        }

        function filtrarTabela() {
            const termo = document.getElementById('buscaInput').value.toLowerCase();
            const linhas = document.querySelectorAll('#tabelaParticipantes tr');
            
            linhas.forEach(tr => {
                const texto = tr.innerText.toLowerCase();
                if(texto.includes(termo)) tr.style.display = '';
                else tr.style.display = 'none';
            });
        }

        function atualizarContadores(dados) {
            let titulares = dados.length;
            let acompanhantes = dados.reduce((acc, curr) => acc + (curr.acompanhantes_qtd || 0), 0);
            
            document.getElementById('countTitulares').innerText = titulares;
            document.getElementById('countAcomp').innerText = acompanhantes;
            document.getElementById('countTotal').innerText = titulares + acompanhantes;
        }

        async function deletarParticipante(id) {
            if(!confirm("Tem certeza que deseja excluir este cadastro permanentemente?")) return;

            const senha = prompt("Confirme a senha de administrador para excluir:");
            if (senha !== SENHA_ADMIN) return alert("Senha incorreta.");

            const { error } = await supabaseClient.from('participantes').delete().eq('id', id);
            
            if(error) alert("Erro ao excluir: " + error.message);
            else {
                alert("Participante removido.");
                carregarParticipantesPainel();
            }
        }

        async function exportarExcel() {
            // Reutiliza o filtro atual
            let query = supabaseClient.from('participantes').select('nome, cpf, telefone, email, acompanhantes_qtd, acompanhantes_info, eventos(nome, data_evento)').order('data_cadastro');
            
            const eventoId = document.getElementById('filtroEvento').value;
            if(eventoId) query = query.eq('evento_id', eventoId);

            const { data } = await query;
            if(!data || !data.length) return alert("Nada para exportar na visão atual.");

            let csv = "\uFEFFNome,CPF,Telefone,Email,Qtd Acomp.,Detalhes Acomp.,Evento,Data Evento\n";
            data.forEach(r => {
                const info = (r.acompanhantes_info || "").replace(/[\n\r,]/g, " ");
                const dataEv = r.eventos?.data_evento ? new Date(r.eventos.data_evento).toLocaleDateString() : "";
                csv += `${r.nome},"${r.cpf}",${r.telefone},${r.email},${r.acompanhantes_qtd},"${info}",${r.eventos?.nome},${dataEv}\n`;
            });

            const link = document.createElement("a");
            link.href = URL.createObjectURL(new Blob([csv], {type: 'text/csv;charset=utf-8;'}));
            link.download = "relatorio_inscritos.csv";
            link.click();
        }
    </script>
</body>
</html>